

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>13. Pypsi Demo Shell &#8212; pypsi 1.4.1 documentation</title>
    
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.4.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="12. pypsi.wizard - Prompt Wizards" href="pypsi.wizard.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pypsi.wizard.html" title="12. pypsi.wizard - Prompt Wizards"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pypsi 1.4.1 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="pypsi.wizard.html"
                        title="previous chapter">12. pypsi.wizard - Prompt Wizards</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pypsi.demo.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="pypsi-demo-shell">
<h1>13. Pypsi Demo Shell<a class="headerlink" href="#pypsi-demo-shell" title="Permalink to this headline">Â¶</a></h1>
<p>The source code for this file is located in <code class="docutils literal"><span class="pre">/demo.py</span></code>. The code is provided
as an example of the overarching Pypsi design and API. The demo shell can be
used as a skeleton for new shells and can be easily modified.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Copyright (c) 2015, Adam Meily &lt;meily.adam@gmail.com&gt;</span>
<span class="c1"># Pypsi - https://github.com/ameily/pypsi</span>
<span class="c1">#</span>
<span class="c1"># Permission to use, copy, modify, and/or distribute this software for any</span>
<span class="c1"># purpose with or without fee is hereby granted, provided that the above</span>
<span class="c1"># copyright notice and this permission notice appear in all copies.</span>
<span class="c1">#</span>
<span class="c1"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND THE AUTHOR DISCLAIMS ALL WARRANTIES</span>
<span class="c1"># WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</span>
<span class="c1"># MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR</span>
<span class="c1"># ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span>
<span class="c1"># WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</span>
<span class="c1"># ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF</span>
<span class="c1"># OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span>
<span class="c1">#</span>


<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">This is an example Pypsi shell using several key features of the Pypsi API and</span>
<span class="sd">architecture. The code is provided as an example of the overarching Pypsi design</span>
<span class="sd">and API. The demo shell can be used as a skeleton for new shells and can be</span>
<span class="sd">easily modified.</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">pypsi.shell</span> <span class="kn">import</span> <span class="n">Shell</span>
<span class="kn">from</span> <span class="nn">pypsi.core</span> <span class="kn">import</span> <span class="n">Command</span>
<span class="kn">from</span> <span class="nn">pypsi.plugins.cmd</span> <span class="kn">import</span> <span class="n">CmdPlugin</span>
<span class="kn">from</span> <span class="nn">pypsi.plugins.block</span> <span class="kn">import</span> <span class="n">BlockPlugin</span>
<span class="kn">from</span> <span class="nn">pypsi.plugins.hexcode</span> <span class="kn">import</span> <span class="n">HexCodePlugin</span>
<span class="kn">from</span> <span class="nn">pypsi.commands.macro</span> <span class="kn">import</span> <span class="n">MacroCommand</span>
<span class="kn">from</span> <span class="nn">pypsi.commands.system</span> <span class="kn">import</span> <span class="n">SystemCommand</span>
<span class="kn">from</span> <span class="nn">pypsi.plugins.multiline</span> <span class="kn">import</span> <span class="n">MultilinePlugin</span>
<span class="kn">from</span> <span class="nn">pypsi.commands.xargs</span> <span class="kn">import</span> <span class="n">XArgsCommand</span>
<span class="kn">from</span> <span class="nn">pypsi.commands.exit</span> <span class="kn">import</span> <span class="n">ExitCommand</span>
<span class="kn">from</span> <span class="nn">pypsi.plugins.variable</span> <span class="kn">import</span> <span class="n">VariablePlugin</span>
<span class="kn">from</span> <span class="nn">pypsi.plugins.history</span> <span class="kn">import</span> <span class="n">HistoryPlugin</span>
<span class="kn">from</span> <span class="nn">pypsi.plugins.alias</span> <span class="kn">import</span> <span class="n">AliasPlugin</span>
<span class="kn">from</span> <span class="nn">pypsi.commands.echo</span> <span class="kn">import</span> <span class="n">EchoCommand</span>
<span class="kn">from</span> <span class="nn">pypsi.commands.include</span> <span class="kn">import</span> <span class="n">IncludeCommand</span>
<span class="kn">from</span> <span class="nn">pypsi.commands.help</span> <span class="kn">import</span> <span class="n">HelpCommand</span><span class="p">,</span> <span class="n">Topic</span>
<span class="kn">from</span> <span class="nn">pypsi.commands.tip</span> <span class="kn">import</span> <span class="n">TipCommand</span>
<span class="kn">from</span> <span class="nn">pypsi.commands.tail</span> <span class="kn">import</span> <span class="n">TailCommand</span>
<span class="kn">from</span> <span class="nn">pypsi.commands.chdir</span> <span class="kn">import</span> <span class="n">ChdirCommand</span>
<span class="kn">from</span> <span class="nn">pypsi.commands.pwd</span> <span class="kn">import</span> <span class="n">PwdCommand</span>
<span class="kn">from</span> <span class="nn">pypsi.plugins.comment</span> <span class="kn">import</span> <span class="n">CommentPlugin</span>

<span class="kn">from</span> <span class="nn">pypsi</span> <span class="kn">import</span> <span class="n">wizard</span> <span class="k">as</span> <span class="n">wiz</span>
<span class="kn">from</span> <span class="nn">pypsi.format</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">Column</span><span class="p">,</span> <span class="n">title_str</span>
<span class="kn">from</span> <span class="nn">pypsi.completers</span> <span class="kn">import</span> <span class="n">path_completer</span>


<span class="kn">from</span> <span class="nn">pypsi.ansi</span> <span class="kn">import</span> <span class="n">AnsiCodes</span>
<span class="kn">from</span> <span class="nn">pypsi</span> <span class="kn">import</span> <span class="n">topics</span>

<span class="kn">from</span> <span class="nn">pypsi.os</span> <span class="kn">import</span> <span class="n">find_bins_in_path</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">ShellTopic</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;These commands are built into the Pypsi shell (all glory and honor to the pypsi shell).</span>
<span class="s2">This is a single newline</span>

<span class="s2">and This is a double&quot;&quot;&quot;</span>



<span class="k">class</span> <span class="nc">WizardCommand</span><span class="p">(</span><span class="n">Command</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Simple command to launch an example configuration wizard.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;wizard&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">WizardCommand</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shell</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="n">ConfigWizard</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">shell</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ns</span><span class="p">:</span>
            <span class="k">print</span><span class="p">()</span>
            <span class="c1"># Create a table with optimally sized columns.</span>
            <span class="n">Table</span><span class="p">(</span>
                <span class="n">columns</span><span class="o">=</span><span class="p">(</span>
                    <span class="c1"># FIrst column is the configuration ID. This column will be</span>
                    <span class="c1"># the minimum width possible without wrapping</span>
                    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;Config ID&#39;</span><span class="p">,</span> <span class="n">Column</span><span class="o">.</span><span class="n">Shrink</span><span class="p">),</span>
                    <span class="c1"># Second column is the configuration value. This column will</span>
                    <span class="c1"># grow to a maximum width possible.</span>
                    <span class="n">Column</span><span class="p">(</span><span class="s1">&#39;Config Value&#39;</span><span class="p">,</span> <span class="n">Column</span><span class="o">.</span><span class="n">Grow</span><span class="p">)</span>
                <span class="p">),</span>
                <span class="c1"># Number of spaces between each column.</span>
                <span class="n">spacing</span><span class="o">=</span><span class="mi">4</span>
            <span class="p">)</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="c1"># Each tuple is a row</span>
                <span class="p">(</span><span class="s1">&#39;ip_addr&#39;</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">ip_addr</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;port&#39;</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">port</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">path</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;mode&#39;</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span> <span class="c1"># Write the table to stdout</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="mi">0</span>

<span class="n">ConfigWizard</span> <span class="o">=</span> <span class="n">wiz</span><span class="o">.</span><span class="n">PromptWizard</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Example Configuration&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Shows various examples of wizard steps&quot;</span><span class="p">,</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">(</span>
        <span class="c1"># The list of input prompts to ask the user.</span>
        <span class="n">wiz</span><span class="o">.</span><span class="n">WizardStep</span><span class="p">(</span>
            <span class="c1"># ID where the value will be stored</span>
            <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;ip_addr&quot;</span><span class="p">,</span>
            <span class="c1"># Display name</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;IP Address&quot;</span><span class="p">,</span>
            <span class="c1"># Help message</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Local IP Address or Host name&quot;</span><span class="p">,</span>
            <span class="c1"># List of validators to run on the input</span>
            <span class="n">validators</span><span class="o">=</span><span class="p">(</span><span class="n">wiz</span><span class="o">.</span><span class="n">required_validator</span><span class="p">,</span> <span class="n">wiz</span><span class="o">.</span><span class="n">hostname_or_ip_validator</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">wiz</span><span class="o">.</span><span class="n">WizardStep</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;port&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;TCP Port&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;TCP port to listen on&quot;</span><span class="p">,</span>
            <span class="n">validators</span><span class="o">=</span><span class="p">(</span><span class="n">wiz</span><span class="o">.</span><span class="n">required_validator</span><span class="p">,</span> <span class="n">wiz</span><span class="o">.</span><span class="n">int_validator</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">65535</span><span class="p">)),</span>
            <span class="n">default</span><span class="o">=</span><span class="mi">1337</span>
        <span class="p">),</span>
        <span class="n">wiz</span><span class="o">.</span><span class="n">WizardStep</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;path&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;File path&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s1">&#39;File path to log file&#39;</span><span class="p">,</span>
            <span class="n">validators</span><span class="o">=</span><span class="n">wiz</span><span class="o">.</span><span class="n">file_validator</span><span class="p">,</span>
            <span class="c1"># Tab complete based on path</span>
            <span class="n">completer</span><span class="o">=</span><span class="n">path_completer</span>
        <span class="p">),</span>
        <span class="n">wiz</span><span class="o">.</span><span class="n">WizardStep</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;mode&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Shell mode&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Mode of the shell&#39;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span>
            <span class="n">validators</span><span class="o">=</span><span class="p">(</span><span class="n">wiz</span><span class="o">.</span><span class="n">required_validator</span><span class="p">,</span> <span class="n">wiz</span><span class="o">.</span><span class="n">choice_validator</span><span class="p">([</span><span class="s1">&#39;local&#39;</span><span class="p">,</span> <span class="s1">&#39;remote&#39;</span><span class="p">]))</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>


<span class="k">class</span> <span class="nc">DemoShell</span><span class="p">(</span><span class="n">Shell</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Example demonstration shell.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># First, add commands and plugins to the shell</span>
    <span class="n">wizard_cmd</span> <span class="o">=</span> <span class="n">WizardCommand</span><span class="p">()</span>
    <span class="n">echo_cmd</span> <span class="o">=</span> <span class="n">EchoCommand</span><span class="p">()</span>
    <span class="n">block_plugin</span> <span class="o">=</span> <span class="n">BlockPlugin</span><span class="p">()</span>
    <span class="n">hexcode_plugin</span> <span class="o">=</span> <span class="n">HexCodePlugin</span><span class="p">()</span>
    <span class="n">macro_cmd</span> <span class="o">=</span> <span class="n">MacroCommand</span><span class="p">()</span>

    <span class="c1"># Drop commands to cmd.exe if the platform is Windows</span>
    <span class="n">system_cmd</span> <span class="o">=</span> <span class="n">SystemCommand</span><span class="p">(</span><span class="n">use_shell</span><span class="o">=</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">))</span>
    <span class="n">ml_plugin</span> <span class="o">=</span> <span class="n">MultilinePlugin</span><span class="p">()</span>
    <span class="n">xargs_cmd</span> <span class="o">=</span> <span class="n">XArgsCommand</span><span class="p">()</span>
    <span class="n">exit_cmd</span> <span class="o">=</span> <span class="n">ExitCommand</span><span class="p">()</span>
    <span class="n">history_plugin</span> <span class="o">=</span> <span class="n">HistoryPlugin</span><span class="p">()</span>
    <span class="n">include_cmd</span> <span class="o">=</span> <span class="n">IncludeCommand</span><span class="p">()</span>
    <span class="n">cmd_plugin</span> <span class="o">=</span> <span class="n">CmdPlugin</span><span class="p">(</span><span class="n">cmd_args</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">tip_cmd</span> <span class="o">=</span> <span class="n">TipCommand</span><span class="p">()</span>
    <span class="n">tail_cmd</span> <span class="o">=</span> <span class="n">TailCommand</span><span class="p">()</span>
    <span class="n">help_cmd</span> <span class="o">=</span> <span class="n">HelpCommand</span><span class="p">()</span>
    <span class="n">var_plugin</span> <span class="o">=</span> <span class="n">VariablePlugin</span><span class="p">(</span><span class="n">case_sensitive</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">comment_plugin</span> <span class="o">=</span> <span class="n">CommentPlugin</span><span class="p">()</span>
    <span class="n">chdir_cmd</span> <span class="o">=</span> <span class="n">ChdirCommand</span><span class="p">()</span>
    <span class="n">pwd_cmd</span> <span class="o">=</span> <span class="n">PwdCommand</span><span class="p">()</span>
    <span class="n">alias_plugin</span> <span class="o">=</span> <span class="n">AliasPlugin</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># You must call the Shell.__init__() method.</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DemoShell</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Attempt to load tips</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tip_cmd</span><span class="o">.</span><span class="n">load_tips</span><span class="p">(</span><span class="s2">&quot;./demo-tips.txt&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;failed to load tips file: demo-tips.txt&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Attempt to load the message of the day (MOTD)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tip_cmd</span><span class="o">.</span><span class="n">load_motd</span><span class="p">(</span><span class="s2">&quot;./demo-motd.txt&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;failed to load message of the day file: demo-motd.txt&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;{gray}[$time]{r} {cyan}pypsi{r} {green})&gt;{r} &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">gray</span><span class="o">=</span><span class="n">AnsiCodes</span><span class="o">.</span><span class="n">gray</span><span class="o">.</span><span class="n">prompt</span><span class="p">(),</span> <span class="n">r</span><span class="o">=</span><span class="n">AnsiCodes</span><span class="o">.</span><span class="n">reset</span><span class="o">.</span><span class="n">prompt</span><span class="p">(),</span>
            <span class="n">cyan</span><span class="o">=</span><span class="n">AnsiCodes</span><span class="o">.</span><span class="n">cyan</span><span class="o">.</span><span class="n">prompt</span><span class="p">(),</span> <span class="n">green</span><span class="o">=</span><span class="n">AnsiCodes</span><span class="o">.</span><span class="n">green</span><span class="o">.</span><span class="n">prompt</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fallback_cmd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">system_cmd</span>

        <span class="c1"># Register the shell topic for the help command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">help_cmd</span><span class="o">.</span><span class="n">add_topic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Topic</span><span class="p">(</span><span class="s2">&quot;shell&quot;</span><span class="p">,</span> <span class="s2">&quot;Builtin Shell Commands&quot;</span><span class="p">))</span>
        <span class="c1"># Add the I/O redirection topic</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">help_cmd</span><span class="o">.</span><span class="n">add_topic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topics</span><span class="o">.</span><span class="n">IoRedirection</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_sys_bins</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">on_cmdloop_begin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">AnsiCodes</span><span class="o">.</span><span class="n">clear_screen</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tip_cmd</span><span class="o">.</span><span class="n">motd</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tip_cmd</span><span class="o">.</span><span class="n">print_motd</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">print</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;No tips registered. Create the demo-tips.txt file for the tip of the day.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tip_cmd</span><span class="o">.</span><span class="n">tips</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">AnsiCodes</span><span class="o">.</span><span class="n">green</span><span class="p">,</span> <span class="s2">&quot;Tip of the Day&quot;</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">AnsiCodes</span><span class="o">.</span><span class="n">reset</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tip_cmd</span><span class="o">.</span><span class="n">print_random_tip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">AnsiCodes</span><span class="o">.</span><span class="n">green</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">AnsiCodes</span><span class="o">.</span><span class="n">reset</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;To see the message of the day. Create the demo-motd.txt file for the MOTD.&quot;</span><span class="p">)</span>

    <span class="c1">############################################################################</span>
    <span class="c1"># This functions demonstrate that existing Python :mod:`cmd` shell commands</span>
    <span class="c1"># work without modification in Pypsi.</span>
    <span class="c1">############################################################################</span>
    <span class="k">def</span> <span class="nf">do_cmddoc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This is some long description for the cmdargs command.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;do_cmdargs(&quot;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">help_cmdout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;this is the help message for the cmdout command&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">do_cmdout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;do_cmdout(&quot;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">get_command_name_completions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sys_bins</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sys_bins</span> <span class="o">=</span> <span class="n">find_bins_in_path</span><span class="p">()</span>

        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">commands</span> <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">)]</span> <span class="o">+</span>
            <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sys_bins</span> <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">)]</span>
        <span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">shell</span> <span class="o">=</span> <span class="n">DemoShell</span><span class="p">()</span>
    <span class="n">rc</span> <span class="o">=</span> <span class="n">shell</span><span class="o">.</span><span class="n">cmdloop</span><span class="p">()</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">rc</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pypsi.wizard.html" title="12. pypsi.wizard - Prompt Wizards"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pypsi 1.4.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, Adam Meily.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.5.
    </div>
  </body>
</html>